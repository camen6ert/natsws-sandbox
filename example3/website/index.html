<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pixi.js/5.1.3/pixi.min.js"></script>
</head>

<body>
    <script>
        let app = new PIXI.Application({ width: 1024, height: 800 });
        document.body.appendChild(app.view);

        const Payload = nats.Payload
        const me = Date.now()

        // create a connection, and register listeners
        const init = async function () {
            // if the connection doesn't resolve, an exception is thrown
            // a real app would allow configuring the URL
            const conn = await nats.connect({ url: 'wss://localhost:9222', payload: Payload.JSON })// handle errors sent by the gnatsd - permissions errors, etc.
            conn.addEventListener('error', (ex) => {
                console.log(ex)
            })

            // handle connection to the server is closed - should disable the ui
            conn.addEventListener('close', () => {
                console.log("close")
            })

            // the chat application listens for messages sent under the subject 'chat'
            conn.subscribe('', (_, msg) => {
                addEntry(msg.data.id === me ? `(me): ${msg.data.m}` : `(${msg.data.id}): ${msg.data.m}`)
            })

            return conn
        }
    </script>
</body>

</html>